<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>northstar.LM | AI Meeting Assistant</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Bebas+Neue&family=Source+Sans+3:wght@300;400;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="css/styles.css?v=36">
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#d4a853">
    <link rel="icon" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 32 32'%3E%3Crect fill='%230a0e17' width='32' height='32' rx='6'/%3E%3Ctext x='16' y='24' font-size='22' text-anchor='middle' fill='%23d4a853'%3E‚≠ê%3C/text%3E%3C/svg%3E" type="image/svg+xml">
</head>
<body>
    <div class="gradient-bg"></div>
    
    <header>
        <div class="logo">
            <span class="logo-icon">&#11088;</span>
            <h1>northstar.LM</h1>
        </div>
        <p class="tagline">Transform your meetings into actionable insights</p>
    </header>

    <main>
        <!-- API Key Section (Collapsible) -->
        <section class="config-section" id="config-section">
            <div class="api-key-collapsed hidden" id="api-key-collapsed">
                <span class="key-status">üîë API Key configured</span>
                <button type="button" id="expand-key-btn" class="btn-text">Edit</button>
            </div>
            <div class="api-key-container" id="api-key-container">
                <label for="api-key">
                    <span class="label-icon">&#128273;</span>
                    OpenAI API Key
                </label>
                <div class="input-group">
                    <input type="password" id="api-key" placeholder="sk-..." autocomplete="off">
                    <button type="button" id="toggle-key" class="icon-btn" title="Show/Hide API Key">
                        &#128065;
                    </button>
                    <button type="button" id="save-key" class="btn-secondary" title="Save to browser">
                        Save
                    </button>
                </div>
                <p class="hint">Your key is stored locally and sent directly to OpenAI. <a href="https://platform.openai.com/api-keys" target="_blank">Get an API key</a></p>
            </div>
        </section>

        <!-- Input Section -->
        <section class="input-section">
            <div class="input-tabs">
                <button class="tab-btn active" data-tab="audio">
                    <span class="tab-icon">&#127908;</span>
                    Audio
                </button>
                <button class="tab-btn" data-tab="pdf">
                    <span class="tab-icon">&#128196;</span>
                    PDF
                </button>
                <button class="tab-btn" data-tab="image">
                    <span class="tab-icon">&#128247;</span>
                    Image
                </button>
                <button class="tab-btn" data-tab="video">
                    <span class="tab-icon">&#127909;</span>
                    Video
                </button>
                <button class="tab-btn" data-tab="text">
                    <span class="tab-icon">&#128221;</span>
                    Text
                </button>
                <button class="tab-btn" data-tab="url">
                    <span class="tab-icon">&#127760;</span>
                    URL
                </button>
            </div>

            <div class="tab-content">
                <div id="audio-tab" class="tab-pane active">
                    <input type="file" id="audio-file" accept=".m4a,.mp3,.webm,.mp4,.mpga,.wav,.mpeg,.ogg,.oga,.flac,audio/*" hidden>
                    <label for="audio-file" class="upload-zone" id="drop-zone">
                        <div class="upload-icon">&#127926;</div>
                        <p>Drag & drop your audio file here</p>
                        <p class="hint">or click to browse</p>
                        <p class="file-types">Supported: MP3, WAV, M4A, OGG, FLAC, MP4, WEBM</p>
                    </label>
                    <div id="file-info" class="file-info hidden">
                        <span class="file-name"></span>
                        <button type="button" class="remove-file">&#10005;</button>
                    </div>
                </div>

                <div id="pdf-tab" class="tab-pane">
                    <input type="file" id="pdf-file" accept=".pdf,application/pdf" hidden>
                    <label for="pdf-file" class="upload-zone" id="pdf-drop-zone">
                        <div class="upload-icon">&#128196;</div>
                        <p>Drag & drop your PDF file here</p>
                        <p class="hint">or click to browse</p>
                        <p class="file-types">Supported: PDF documents</p>
                    </label>
                    <div id="pdf-file-info" class="file-info hidden">
                        <span class="pdf-file-name"></span>
                        <button type="button" class="remove-pdf-file">&#10005;</button>
                    </div>
                </div>

                <div id="image-tab" class="tab-pane">
                    <input type="file" id="image-file" accept=".jpg,.jpeg,.png,.gif,.webp,image/*" hidden>
                    <label for="image-file" class="upload-zone" id="image-drop-zone">
                        <div class="upload-icon">&#128247;</div>
                        <p>Drag & drop your image file here</p>
                        <p class="hint">or click to browse</p>
                        <p class="file-types">Supported: JPG, PNG, GIF, WebP</p>
                    </label>
                    <div id="image-file-info" class="file-info hidden">
                        <span class="image-file-name"></span>
                        <button type="button" class="remove-image-file">&#10005;</button>
                    </div>
                    <div id="image-preview" class="image-preview hidden">
                        <img id="image-preview-img" alt="Image preview" />
                    </div>
                </div>

                <div id="video-tab" class="tab-pane">
                    <input type="file" id="video-file" accept=".mp4,.webm,.mpeg,.m4a,.wav,.mp3,video/mp4,video/webm" hidden>
                    <label for="video-file" class="upload-zone" id="video-drop-zone">
                        <div class="upload-icon">&#127909;</div>
                        <p>Drag & drop your video file here</p>
                        <p class="hint">or click to browse</p>
                        <p class="file-types">Supported: MP4, WebM, MPEG (Whisper-compatible formats)</p>
                    </label>
                    <div id="video-file-info" class="file-info hidden">
                        <span class="video-file-name"></span>
                        <button type="button" class="remove-video-file">&#10005;</button>
                    </div>
                </div>

                <div id="text-tab" class="tab-pane">
                    <textarea id="text-input" placeholder="Paste your meeting transcript or notes here..."></textarea>
                </div>

                <div id="url-tab" class="tab-pane">
                    <div class="url-input-container">
                        <div class="url-input-wrapper">
                            <span class="url-icon">üîó</span>
                            <input type="url" id="url-input" placeholder="https://example.com/meeting-notes" />
                            <button id="fetch-url-btn" class="btn-fetch" type="button">
                                <span class="btn-text">Fetch</span>
                                <span class="btn-loader hidden">
                                    <span class="spinner-small"></span>
                                </span>
                            </button>
                        </div>
                        <p class="url-hint">Enter a webpage URL to extract its text content</p>
                    </div>
                    <div id="url-preview" class="url-preview hidden">
                        <div class="url-preview-header">
                            <span class="url-preview-title">Extracted Content</span>
                            <button type="button" class="clear-url-btn">&#10005; Clear</button>
                        </div>
                        <div class="url-preview-content" id="url-preview-content"></div>
                    </div>
                </div>
            </div>

            <button id="analyze-btn" class="btn-primary" disabled title="Analyze your meeting recording, PDF, or text to extract insights">
                <span class="btn-text">Analyze Meeting</span>
                <span class="btn-loader hidden">
                    <span class="spinner"></span>
                    Processing...
                </span>
            </button>

            <!-- Agent Tools -->
            <div class="agent-tools-section">
                <div class="agent-divider">
                    <span>or</span>
                </div>
                <div class="agent-buttons">
                    <div class="agent-tool">
                        <button id="import-agent-btn" class="btn-agent-import">
                            <span>üì•</span> Import Agent
                        </button>
                        <input type="file" id="agent-file" accept=".md,text/markdown" hidden>
                        <p class="agent-hint">Load a previously exported meeting agent</p>
                    </div>
                    <div class="agent-tool">
                        <a href="orchestrator.html" class="btn-agent-orchestrator">
                            <span>üé≠</span> Agent Orchestrator
                        </a>
                        <p class="agent-hint">Combine multiple agents for cross-meeting insights</p>
                    </div>
                </div>
            </div>
        </section>

        <!-- Progress Section -->
        <section id="progress-section" class="progress-section hidden">
            <div class="progress-bar">
                <div class="progress-fill"></div>
            </div>
            <p class="progress-text">Initializing...</p>
        </section>

        <!-- Results Section -->
        <section id="results-section" class="results-section hidden">
            <h2>Analysis Results</h2>
            
            <!-- KPI Dashboard -->
            <div class="kpi-dashboard">
                <div class="kpi-item kpi-sentiment">
                    <span class="kpi-icon">üìä</span>
                    <div class="kpi-content">
                        <span class="kpi-label">Sentiment</span>
                        <span class="kpi-value" id="kpi-sentiment">--</span>
                    </div>
                </div>
                <div class="kpi-item">
                    <span class="kpi-icon">üìù</span>
                    <div class="kpi-content">
                        <span class="kpi-label">Words Analyzed</span>
                        <span class="kpi-value" id="kpi-words">--</span>
                    </div>
                </div>
                <div class="kpi-item">
                    <span class="kpi-icon">üí°</span>
                    <div class="kpi-content">
                        <span class="kpi-label">Key Points</span>
                        <span class="kpi-value" id="kpi-keypoints">--</span>
                    </div>
                </div>
                <div class="kpi-item">
                    <span class="kpi-icon">‚úÖ</span>
                    <div class="kpi-content">
                        <span class="kpi-label">Action Items</span>
                        <span class="kpi-value" id="kpi-actions">--</span>
                    </div>
                </div>
                <div class="kpi-item">
                    <span class="kpi-icon">‚è±Ô∏è</span>
                    <div class="kpi-content">
                        <span class="kpi-label">Read Time</span>
                        <span class="kpi-value" id="kpi-readtime">--</span>
                    </div>
                </div>
                <div class="kpi-item">
                    <span class="kpi-icon">üéØ</span>
                    <div class="kpi-content">
                        <span class="kpi-label">Topics</span>
                        <span class="kpi-value" id="kpi-topics">--</span>
                    </div>
                </div>
            </div>
            
            <div class="results-grid">
                <div class="result-card">
                    <div class="card-header">
                        <span class="card-icon">&#128196;</span>
                        <h3>Summary</h3>
                    </div>
                    <div class="card-content" id="result-summary">
                        <!-- Summary will be inserted here -->
                    </div>
                </div>

                <div class="result-card">
                    <div class="card-header">
                        <span class="card-icon">&#128161;</span>
                        <h3>Key Points</h3>
                    </div>
                    <div class="card-content" id="result-keypoints">
                        <!-- Key points will be inserted here -->
                    </div>
                </div>

                <div class="result-card">
                    <div class="card-header">
                        <span class="card-icon">&#9989;</span>
                        <h3>Action Items</h3>
                    </div>
                    <div class="card-content" id="result-actions">
                        <!-- Action items will be inserted here -->
                    </div>
                </div>

                <div class="result-card sentiment-card">
                    <div class="card-header">
                        <span class="card-icon">&#128200;</span>
                        <h3>Sentiment</h3>
                    </div>
                    <div class="card-content" id="result-sentiment">
                        <!-- Sentiment will be inserted here -->
                    </div>
                </div>

                <details class="result-card metrics-card">
                    <summary class="card-header card-header-collapsible">
                        <span class="card-icon">&#128202;</span>
                        <h3>Usage Metrics</h3>
                        <span class="collapse-toggle">‚ñº</span>
                    </summary>
                    <div class="card-content" id="result-metrics">
                        <!-- Metrics will be inserted here -->
                    </div>
                </details>
            </div>

            <div class="results-actions">
                <button id="download-btn" class="btn-primary" title="Download analysis results as a formatted Word document">
                    <span>&#128229;</span> Download DOCX
                </button>
                <button id="export-agent-btn" class="btn-secondary" title="Export analysis as markdown file for Agent Orchestrator">
                    <span>ü§ñ</span> Export Agent
                </button>
                <button id="new-analysis-btn" class="btn-secondary" title="Start a new analysis (clears current results)">
                    <span>&#10227;</span> New Analysis
                </button>
            </div>

            <!-- Chat with Data Section -->
            <div class="feature-section" id="chat-section">
                <div class="feature-header">
                    <h3><span>üí¨</span> Ask Questions</h3>
                    <p class="feature-desc">Chat with your meeting data using AI</p>
                </div>
                
                <div class="chat-container">
                    <div class="chat-messages" id="chat-messages">
                        <div class="chat-welcome">
                            <div class="chat-welcome-icon">ü§ñ</div>
                            <div class="chat-welcome-text">
                                <strong>Meeting Assistant</strong>
                                <p>I have access to your transcript and analysis. Ask me about decisions, action items, specific topics, or anything else from the meeting.</p>
                            </div>
                        </div>
                    </div>
                    
                    <div class="chat-input-area">
                        <input type="text" id="chat-input" placeholder="Type your question here..." autocomplete="off" />
                        <button id="chat-send-btn" class="btn-chat-send" title="Send message">
                            <span class="btn-text">‚û§</span>
                            <span class="btn-loader hidden">
                                <span class="spinner-small"></span>
                            </span>
                        </button>
                    </div>
                </div>
            </div>

            <!-- Audio Briefing Section -->
            <div class="feature-section" id="audio-briefing-section">
                <h3><span>&#127911;</span> Audio Briefing</h3>
                <p class="feature-desc">Generate a 2-minute executive audio summary</p>
                
                <div class="feature-controls">
                    <div class="voice-selector">
                        <label for="voice-select">Voice:</label>
                        <select id="voice-select">
                            <option value="alloy">Alloy (Neutral)</option>
                            <option value="echo">Echo (Male)</option>
                            <option value="fable">Fable (British)</option>
                            <option value="onyx">Onyx (Deep Male)</option>
                            <option value="nova" selected>Nova (Female)</option>
                            <option value="shimmer">Shimmer (Soft Female)</option>
                        </select>
                    </div>
                    <button id="generate-audio-btn" class="btn-secondary" title="Convert meeting summary to spoken audio briefing">
                        <span class="btn-text">&#127908; Generate Audio</span>
                        <span class="btn-loader hidden">
                            <span class="spinner"></span>
                            Generating...
                        </span>
                    </button>
                </div>

                <div id="audio-player-container" class="audio-player-container hidden">
                    <audio id="audio-player" controls></audio>
                    <button id="download-audio-btn" class="btn-secondary" title="Download audio briefing as MP3 file">
                        <span>&#128229;</span> Download MP3
                    </button>
                </div>
            </div>

            <!-- Infographic Section -->
            <div class="feature-section" id="infographic-section">
                <h3><span>&#127912;</span> Meeting Infographic</h3>
                <p class="feature-desc">Create a visual infographic from your meeting insights</p>
                
                <div class="feature-controls">
                    <div class="prompt-input-group">
                        <input type="text" id="infographic-prompt" placeholder="Describe your preferred style (e.g., 'colorful corporate with icons')" />
                    </div>
                    <button id="generate-infographic-btn" class="btn-secondary" title="Generate a visual infographic from meeting insights using AI">
                        <span class="btn-text">&#127912; Generate Infographic</span>
                        <span class="btn-loader hidden">
                            <span class="spinner"></span>
                            Creating...
                        </span>
                    </button>
                </div>

                <div id="infographic-container" class="infographic-container hidden">
                    <img id="infographic-image" alt="Meeting Infographic" />
                    <button id="download-infographic-btn" class="btn-secondary" title="Download infographic as PNG image">
                        <span>&#128229;</span> Download Image
                    </button>
                </div>
            </div>

        </section>

        <!-- Error Section -->
        <section id="error-section" class="error-section hidden">
            <div class="error-content">
                <span class="error-icon">&#9888;</span>
                <p id="error-message"></p>
                <button id="dismiss-error" class="btn-secondary">Dismiss</button>
            </div>
        </section>

        <!-- About Section -->
        <section class="about-section">
            <details class="about-card">
                <summary class="about-header">
                    <span class="about-icon">‚ÑπÔ∏è</span>
                    <span>About northstar.LM</span>
                    <span class="about-toggle">‚ñº</span>
                </summary>
                <div class="about-content">
                    <p class="about-intro">
                        northstar.LM transforms meeting recordings, videos, documents, images, and text into actionable insights using OpenAI's latest AI models.
                    </p>
                    <div class="models-grid">
                        <div class="model-item">
                            <span class="model-icon">üé§</span>
                            <div class="model-info">
                                <strong>Whisper</strong>
                                <span>Audio & video transcription</span>
                            </div>
                        </div>
                        <div class="model-item">
                            <span class="model-icon">üß†</span>
                            <div class="model-info">
                                <strong>GPT-5.2</strong>
                                <span>Analysis, reasoning & chat</span>
                            </div>
                        </div>
                        <div class="model-item">
                            <span class="model-icon">üëÅÔ∏è</span>
                            <div class="model-info">
                                <strong>GPT-5.2 Vision</strong>
                                <span>Image & PDF OCR analysis</span>
                            </div>
                        </div>
                        <div class="model-item">
                            <span class="model-icon">üîä</span>
                            <div class="model-info">
                                <strong>GPT-4o-mini-TTS</strong>
                                <span>Audio generation</span>
                            </div>
                        </div>
                        <div class="model-item">
                            <span class="model-icon">üé®</span>
                            <div class="model-info">
                                <strong>GPT-Image-1.5</strong>
                                <span>Infographic creation</span>
                            </div>
                        </div>
                    </div>
                    <p class="about-privacy">
                        üîí Your API key stays local. All data goes directly to OpenAI‚Äîno third-party servers.
                    </p>
                </div>
            </details>
        </section>
    </main>

    <footer>
        <p>&copy; 2026 northstar.LM | Your meetings, distilled.</p>
        <p class="credits">
            Powered by
            <a href="https://openai.com" target="_blank">OpenAI Whisper, GPT-5.2, GPT-5.2 Vision, GPT-4o-mini-TTS & GPT-Image-1.5</a>
        </p>
    </footer>

    <!-- External Libraries -->
    <script src="https://unpkg.com/docx@8.5.0/build/index.umd.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/4.0.379/pdf.min.mjs" type="module"></script>
    <script src="js/app.js?v=37" type="module"></script>

    <!-- Service Worker Registration -->
    <script>
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('./sw.js')
                    .then(registration => {
                        console.log('[PWA] Service Worker registered:', registration.scope);
                    })
                    .catch(error => {
                        console.log('[PWA] Service Worker registration failed:', error);
                    });
            });
        }
    </script>
</body>
</html>
