<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>northstar.LM | AI Meeting Assistant</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Bebas+Neue&family=Source+Sans+3:wght@300;400;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="css/styles.css?v=49">
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#d4a853">
    <link rel="icon" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 32 32'%3E%3Crect fill='%230a0e17' width='32' height='32' rx='6'/%3E%3Ctext x='16' y='24' font-size='22' text-anchor='middle' fill='%23d4a853'%3E‚≠ê%3C/text%3E%3C/svg%3E" type="image/svg+xml">
</head>
<body>
    <div class="gradient-bg"></div>
    
    <header>
        <div class="header-content">
            <div class="logo">
                <img src="images/k-northstar-logo.png" alt="northstar.LM" class="logo-image">
                <div class="logo-text">
                    <h1>northstar.LM</h1>
                    <span class="app-subtitle">Agent Builder</span>
                </div>
            </div>
            <div class="about-dropdown-container">
                <button class="about-btn" id="about-btn" title="About northstar.LM">
                    <span>‚ÑπÔ∏è</span> About
                </button>
                <div class="about-dropdown hidden" id="about-dropdown">
                    <p class="about-intro">
                        northstar.LM Agent Builder transforms recordings, videos, documents, images, and text into actionable insights using OpenAI's latest AI models.
                    </p>
                    <div class="about-models">
                        <span class="model-tag">üé§ Whisper</span>
                        <span class="model-tag">üß† GPT-5.2</span>
                        <span class="model-tag">üëÅÔ∏è Vision</span>
                        <span class="model-tag">üîä TTS</span>
                        <span class="model-tag">üé® Image</span>
                    </div>
                    <p class="about-privacy">üîí Your API key stays local‚Äîdata goes directly to OpenAI.</p>
                </div>
            </div>
        </div>
        <p class="tagline">Transform your meetings into actionable insights</p>
        <button id="help-btn" class="help-btn" title="How to use this app">?</button>
    </header>

    <main>
        <section class="model-settings" id="model-settings">
            <div class="setting-group">
                <label for="model-select">Model</label>
                <select id="model-select">
                    <option value="gpt-5.2">GPT-5.2</option>
                    <option value="gpt-5-mini">GPT-5-mini</option>
                    <option value="gpt-5-nano">GPT-5-nano</option>
                </select>
            </div>
            <div class="setting-group" id="effort-group">
                <label for="effort-select">Effort</label>
                <select id="effort-select">
                    <option value="none">None</option>
                    <option value="low">Low</option>
                    <option value="medium">Medium</option>
                    <option value="high">High</option>
                </select>
            </div>
            <div class="setting-group">
                <label for="rlm-toggle">RLM</label>
                <label class="toggle-switch">
                    <input type="checkbox" id="rlm-toggle">
                    <span class="toggle-slider"></span>
                </label>
            </div>
            <div class="setting-group">
                <label for="rlm-auto-toggle">RLM Auto</label>
                <label class="toggle-switch">
                    <input type="checkbox" id="rlm-auto-toggle">
                    <span class="toggle-slider"></span>
                </label>
            </div>
            <div class="setting-group">
                <label for="shadow-prompt-toggle">Shadow Prompt</label>
                <label class="toggle-switch">
                    <input type="checkbox" id="shadow-prompt-toggle">
                    <span class="toggle-slider"></span>
                </label>
            </div>
            <div class="setting-group">
                <label for="focus-shadow-toggle">Focus Shadow</label>
                <label class="toggle-switch">
                    <input type="checkbox" id="focus-shadow-toggle">
                    <span class="toggle-slider"></span>
                </label>
            </div>
            <div class="setting-group">
                <label for="focus-episodes-toggle">Focus Episodes</label>
                <label class="toggle-switch">
                    <input type="checkbox" id="focus-episodes-toggle">
                    <span class="toggle-slider"></span>
                </label>
            </div>
            <div class="setting-group">
                <label for="prompt-budget-toggle">Prompt Budgeting</label>
                <label class="toggle-switch">
                    <input type="checkbox" id="prompt-budget-toggle">
                    <span class="toggle-slider"></span>
                </label>
            </div>
            <div class="setting-group">
                <label for="memory-debug-toggle">Memory Debug</label>
                <label class="toggle-switch">
                    <input type="checkbox" id="memory-debug-toggle">
                    <span class="toggle-slider"></span>
                </label>
            </div>
        </section>

        <section class="context-gauge" id="context-gauge">
            <div class="context-gauge-header">
                <div class="context-gauge-title">Context Window</div>
                <div class="context-gauge-meta">
                    <span class="context-gauge-status" id="context-gauge-status">Healthy</span>
                    <span id="context-gauge-usage">Ready</span>
                </div>
            </div>
            <div class="context-gauge-bars">
                <div class="context-gauge-row">
                    <span class="context-gauge-label">RLM Context</span>
                    <div class="context-gauge-bar">
                        <span class="context-gauge-fill" id="context-gauge-rom-fill"></span>
                    </div>
                    <span class="context-gauge-value" id="context-gauge-rom-value">0%</span>
                </div>
                <div class="context-gauge-row">
                    <span class="context-gauge-label">Raw Context</span>
                    <div class="context-gauge-bar context-gauge-bar-raw">
                        <span class="context-gauge-fill context-gauge-fill-raw" id="context-gauge-raw-fill"></span>
                    </div>
                    <span class="context-gauge-value" id="context-gauge-raw-value">0%</span>
                </div>
            </div>
            <div class="context-gauge-footnote" id="context-gauge-footnote">
                Add meetings and a query to estimate context usage.
            </div>
        </section>
        <!-- Setup & Input Section (Collapsible after analysis) -->
        <details class="setup-section" id="setup-section" open>
            <summary class="setup-header">
                <span class="setup-icon">‚öôÔ∏è</span>
                <span class="setup-title">Setup & Input</span>
                <span class="setup-toggle">‚ñº</span>
            </summary>
            
            <div class="setup-content">
                <!-- API Key Section -->
                <section class="config-section" id="config-section">
                    <div class="api-key-collapsed hidden" id="api-key-collapsed">
                        <span class="key-status">üîë API Key configured</span>
                        <button type="button" id="expand-key-btn" class="btn-text">Edit</button>
                    </div>
                    <div class="api-key-container" id="api-key-container">
                        <label for="api-key">
                            <span class="label-icon">&#128273;</span>
                            OpenAI API Key
                        </label>
                        <div class="input-group">
                            <input type="password" id="api-key" placeholder="sk-..." autocomplete="off">
                            <button type="button" id="toggle-key" class="icon-btn" title="Show/Hide API Key">
                                &#128065;
                            </button>
                            <button type="button" id="save-key" class="btn-secondary" title="Save to browser">
                                Save
                            </button>
                        </div>
                        <p class="hint">Your key is stored locally and sent directly to OpenAI. <a href="https://platform.openai.com/api-keys" target="_blank">Get an API key</a></p>
                    </div>
                </section>

                <!-- Input Section -->
                <section class="input-section">
            <div class="input-tabs">
                <button class="tab-btn active" data-tab="audio">
                    <span class="tab-icon">&#127908;</span>
                    Audio
                </button>
                <button class="tab-btn" data-tab="pdf">
                    <span class="tab-icon">&#128196;</span>
                    PDF
                </button>
                <button class="tab-btn" data-tab="image">
                    <span class="tab-icon">&#128247;</span>
                    Image
                </button>
                <button class="tab-btn" data-tab="video">
                    <span class="tab-icon">&#127909;</span>
                    Video
                </button>
                <button class="tab-btn" data-tab="text">
                    <span class="tab-icon">&#128221;</span>
                    Text
                </button>
                <button class="tab-btn" data-tab="url">
                    <span class="tab-icon">&#127760;</span>
                    URL
                </button>
                <button class="tab-btn" data-tab="wearable" id="wearable-tab-btn">
                    <span class="tab-icon">‚åö</span>
                    Wearable
                    <span class="coming-soon-badge">Coming Soon</span>
                </button>
            </div>

            <div class="tab-content">
                <div id="audio-tab" class="tab-pane active">
                    <input type="file" id="audio-file" accept=".m4a,.mp3,.webm,.mp4,.mpga,.wav,.mpeg,.ogg,.oga,.flac,audio/*" hidden>
                    <label for="audio-file" class="upload-zone" id="drop-zone">
                        <div class="upload-icon">&#127926;</div>
                        <p>Drag & drop your audio file here</p>
                        <p class="hint">or click to browse</p>
                        <p class="file-types">Supported: MP3, WAV, M4A, OGG, FLAC, MP4, WEBM</p>
                    </label>
                    <div id="file-info" class="file-info hidden">
                        <span class="file-name"></span>
                        <button type="button" class="remove-file">&#10005;</button>
                    </div>
                </div>

                <div id="pdf-tab" class="tab-pane">
                    <input type="file" id="pdf-file" accept=".pdf,application/pdf" hidden>
                    <label for="pdf-file" class="upload-zone" id="pdf-drop-zone">
                        <div class="upload-icon">&#128196;</div>
                        <p>Drag & drop your PDF file here</p>
                        <p class="hint">or click to browse</p>
                        <p class="file-types">Supported: PDF documents</p>
                    </label>
                    <div id="pdf-file-info" class="file-info hidden">
                        <span class="pdf-file-name"></span>
                        <button type="button" class="remove-pdf-file">&#10005;</button>
                    </div>
                </div>

                <div id="image-tab" class="tab-pane">
                    <input type="file" id="image-file" accept=".jpg,.jpeg,.png,.gif,.webp,image/*" hidden>
                    <label for="image-file" class="upload-zone" id="image-drop-zone">
                        <div class="upload-icon">&#128247;</div>
                        <p>Drag & drop your image file here</p>
                        <p class="hint">or click to browse</p>
                        <p class="file-types">Supported: JPG, PNG, GIF, WebP</p>
                    </label>
                    <div id="image-file-info" class="file-info hidden">
                        <span class="image-file-name"></span>
                        <button type="button" class="remove-image-file">&#10005;</button>
                    </div>
                    <div id="image-preview" class="image-preview hidden">
                        <img id="image-preview-img" alt="Image preview" />
                    </div>
                </div>

                <div id="video-tab" class="tab-pane">
                    <input type="file" id="video-file" accept=".mp4,.webm,.mpeg,.m4a,.wav,.mp3,video/mp4,video/webm" hidden>
                    <label for="video-file" class="upload-zone" id="video-drop-zone">
                        <div class="upload-icon">&#127909;</div>
                        <p>Drag & drop your video file here</p>
                        <p class="hint">or click to browse</p>
                        <p class="file-types">Supported: MP4, WebM, MPEG (Whisper-compatible formats)</p>
                    </label>
                    <div id="video-file-info" class="file-info hidden">
                        <span class="video-file-name"></span>
                        <button type="button" class="remove-video-file">&#10005;</button>
                    </div>
                </div>

                <div id="text-tab" class="tab-pane">
                    <textarea id="text-input" placeholder="Paste your meeting transcript or notes here..."></textarea>
                </div>

                <div id="url-tab" class="tab-pane">
                    <div class="url-input-container">
                        <div class="url-input-wrapper">
                            <span class="url-icon">üîó</span>
                            <input type="url" id="url-input" placeholder="https://example.com/meeting-notes" />
                            <button id="fetch-url-btn" class="btn-fetch" type="button">
                                <span class="btn-text">Fetch</span>
                                <span class="btn-loader hidden">
                                    <span class="spinner-small"></span>
                                </span>
                            </button>
                        </div>
                        <p class="url-hint">Enter a webpage URL to extract its text content</p>
                    </div>
                    <div id="url-preview" class="url-preview hidden">
                        <div class="url-preview-header">
                            <span class="url-preview-title">Extracted Content</span>
                            <button type="button" class="clear-url-btn">&#10005; Clear</button>
                        </div>
                        <div class="url-preview-content" id="url-preview-content"></div>
                    </div>
                </div>

                <div id="wearable-tab" class="tab-pane">
                    <div class="wearable-coming-soon">
                        <div class="wearable-icon">‚åö</div>
                        <h3>AI Wearable Integration</h3>
                        <p class="wearable-status">Coming Soon</p>
                        <p class="wearable-desc">Connect your AI wearable device to automatically import meeting recordings, conversations, and insights.</p>
                    </div>
                </div>
            </div>

            <button id="analyze-btn" class="btn-primary btn-analyze" disabled title="Analyze your meeting recording, PDF, or text to extract insights">
                <span class="btn-text">Analyze Meeting</span>
                <span class="btn-loader hidden">
                    <span class="spinner"></span>
                    Processing...
                </span>
            </button>

            <!-- Agent Tools -->
            <div class="agent-tools-section">
                <div class="agent-divider">
                    <span>or</span>
                </div>
                <div class="agent-buttons">
                    <div class="agent-tool">
                        <button id="import-agent-btn" class="btn-agent-import">
                            <span>üì•</span> Import Agent
                        </button>
                        <input type="file" id="agent-file" accept=".md,text/markdown" hidden>
                        <p class="agent-hint">Load a previously exported meeting agent</p>
                    </div>
                    <div class="agent-tool">
                        <a href="orchestrator.html" class="btn-agent-orchestrator">
                            <span>üé≠</span> Agent Orchestrator
                        </a>
                        <p class="agent-hint">Combine multiple agents for cross-meeting insights</p>
                    </div>
                </div>
            </div>
                </section>
            </div>
        </details>

        <!-- Progress Section -->
        <section id="progress-section" class="progress-section hidden">
            <div class="progress-bar">
                <div class="progress-fill"></div>
            </div>
            <p class="progress-text">Initializing...</p>
        </section>

        <!-- Results Section -->
        <section id="results-section" class="results-section hidden">
            <h2>Analysis Results</h2>
            
            <!-- Quick Navigation Bar -->
            <nav class="results-nav" id="results-nav">
                <a href="#kpi-section" class="nav-pill active" data-section="kpi-section">
                    <span>üìä</span><span class="nav-label">Overview</span>
                </a>
                <a href="#summary-section" class="nav-pill" data-section="summary-section">
                    <span>üìÑ</span><span class="nav-label">Summary</span>
                </a>
                <a href="#keypoints-section" class="nav-pill" data-section="keypoints-section">
                    <span>üí°</span><span class="nav-label">Key Points</span>
                </a>
                <a href="#actions-section" class="nav-pill" data-section="actions-section">
                    <span>‚úÖ</span><span class="nav-label">Actions</span>
                </a>
                <a href="#chat-section" class="nav-pill" data-section="chat-section">
                    <span>üí¨</span><span class="nav-label">Chat</span>
                </a>
                <a href="#audio-briefing-section" class="nav-pill" data-section="audio-briefing-section">
                    <span>üéß</span><span class="nav-label">Audio</span>
                </a>
                <a href="#infographic-section" class="nav-pill" data-section="infographic-section">
                    <span>üé®</span><span class="nav-label">Visual</span>
                </a>
            </nav>
            
            <!-- KPI Dashboard -->
            <div class="kpi-dashboard" id="kpi-section">
                <div class="kpi-item kpi-sentiment">
                    <span class="kpi-icon">üìä</span>
                    <div class="kpi-content">
                        <span class="kpi-label">Sentiment</span>
                        <span class="kpi-value" id="kpi-sentiment">--</span>
                    </div>
                </div>
                <div class="kpi-item">
                    <span class="kpi-icon">üìù</span>
                    <div class="kpi-content">
                        <span class="kpi-label">Words Analyzed</span>
                        <span class="kpi-value" id="kpi-words">--</span>
                    </div>
                </div>
                <div class="kpi-item">
                    <span class="kpi-icon">üí°</span>
                    <div class="kpi-content">
                        <span class="kpi-label">Key Points</span>
                        <span class="kpi-value" id="kpi-keypoints">--</span>
                    </div>
                </div>
                <div class="kpi-item">
                    <span class="kpi-icon">‚úÖ</span>
                    <div class="kpi-content">
                        <span class="kpi-label">Action Items</span>
                        <span class="kpi-value" id="kpi-actions">--</span>
                    </div>
                </div>
                <div class="kpi-item">
                    <span class="kpi-icon">‚è±Ô∏è</span>
                    <div class="kpi-content">
                        <span class="kpi-label">Read Time</span>
                        <span class="kpi-value" id="kpi-readtime">--</span>
                    </div>
                </div>
                <div class="kpi-item">
                    <span class="kpi-icon">üéØ</span>
                    <div class="kpi-content">
                        <span class="kpi-label">Topics</span>
                        <span class="kpi-value" id="kpi-topics">--</span>
                    </div>
                </div>
            </div>

            <!-- Action Buttons - Moved up for visibility -->
            <div class="results-actions">
                <button id="download-btn" class="btn-primary" title="Download analysis results as a formatted Word document">
                    <span>&#128229;</span> Download DOCX
                </button>
                <button id="export-agent-btn" class="btn-secondary" title="Export analysis as markdown file for Agent Orchestrator">
                    <span>ü§ñ</span> Export Agent
                </button>
                <button id="new-analysis-btn" class="btn-secondary" title="Start a new analysis (clears current results)">
                    <span>&#10227;</span> New Analysis
                </button>
            </div>
            
            <!-- Results Cards - All Collapsible -->
            <div class="results-grid">
                <details class="result-card" id="summary-section" open>
                    <summary class="card-header card-header-collapsible">
                        <span class="card-icon">&#128196;</span>
                        <h3>Summary</h3>
                        <span class="collapse-toggle">‚ñº</span>
                    </summary>
                    <div class="card-content" id="result-summary">
                        <!-- Summary will be inserted here -->
                    </div>
                </details>

                <details class="result-card" id="keypoints-section">
                    <summary class="card-header card-header-collapsible">
                        <span class="card-icon">&#128161;</span>
                        <h3>Key Points</h3>
                        <span class="collapse-toggle">‚ñº</span>
                    </summary>
                    <div class="card-content" id="result-keypoints">
                        <!-- Key points will be inserted here -->
                    </div>
                </details>

                <details class="result-card" id="actions-section">
                    <summary class="card-header card-header-collapsible">
                        <span class="card-icon">&#9989;</span>
                        <h3>Action Items</h3>
                        <span class="collapse-toggle">‚ñº</span>
                    </summary>
                    <div class="card-content" id="result-actions">
                        <!-- Action items will be inserted here -->
                    </div>
                </details>

                <details class="result-card" id="memory-debug-section">
                    <summary class="card-header card-header-collapsible">
                        <span class="card-icon">üß†</span>
                        <h3>Memory Debug Panel</h3>
                        <span class="collapse-toggle">‚ñº</span>
                    </summary>
                    <div class="card-content" id="result-memory-debug">
                        <p class="muted">Enable memory debug in the orchestrator to view state, retrieval, and token breakdowns.</p>
                    </div>
                </details>
            </div>

            <!-- Chat with Data Section -->
            <div class="feature-section" id="chat-section">
                <div class="feature-header">
                    <h3><span>üí¨</span> Ask Questions</h3>
                    <p class="feature-desc">Chat with your meeting data using AI</p>
                </div>
                
                <div class="chat-container">
                    <div class="chat-messages" id="chat-messages">
                        <div class="chat-welcome">
                            <div class="chat-welcome-icon">ü§ñ</div>
                            <div class="chat-welcome-text">
                                <strong>Meeting Assistant</strong>
                                <p>I have access to your transcript and analysis. Ask me about decisions, action items, specific topics, or anything else from the meeting.</p>
                            </div>
                        </div>
                    </div>
                    
                    <div class="chat-input-area">
                        <input type="text" id="chat-input" placeholder="Type your question here..." autocomplete="off" />
                        <button id="chat-send-btn" class="btn-chat-send" title="Send message">
                            <span class="btn-text">‚û§</span>
                            <span class="btn-loader hidden">
                                <span class="spinner-small"></span>
                            </span>
                        </button>
                    </div>
                </div>
            </div>

            <!-- Audio Briefing Section -->
            <div class="feature-section" id="audio-briefing-section">
                <h3><span>&#127911;</span> Audio Briefing</h3>
                <p class="feature-desc">Generate a 2-minute executive audio summary</p>
                
                <div class="feature-controls">
                    <div class="prompt-input-group">
                        <input type="text" id="audio-prompt" placeholder="Customize style (e.g., 'upbeat and motivational', 'formal board presentation')" />
                    </div>
                </div>
                
                <div class="feature-controls" style="margin-top: var(--space-md);">
                    <div class="voice-selector">
                        <label for="voice-select">Voice:</label>
                        <select id="voice-select">
                            <option value="alloy">Alloy (Neutral)</option>
                            <option value="echo">Echo (Male)</option>
                            <option value="fable">Fable (British)</option>
                            <option value="onyx">Onyx (Deep Male)</option>
                            <option value="nova" selected>Nova (Female)</option>
                            <option value="shimmer">Shimmer (Soft Female)</option>
                        </select>
                    </div>
                    <button id="generate-audio-btn" class="btn-secondary" title="Convert meeting summary to spoken audio briefing">
                        <span class="btn-text">&#127908; Generate Audio</span>
                        <span class="btn-loader hidden">
                            <span class="spinner"></span>
                            Generating...
                        </span>
                    </button>
                </div>

                <div id="audio-player-container" class="audio-player-container hidden">
                    <audio id="audio-player" controls></audio>
                    <button id="download-audio-btn" class="btn-secondary" title="Download audio briefing as MP3 file">
                        <span>&#128229;</span> Download MP3
                    </button>
                </div>
            </div>

            <!-- Infographic Section -->
            <div class="feature-section" id="infographic-section">
                <h3><span>&#127912;</span> Meeting Infographic</h3>
                <p class="feature-desc">Create a visual infographic from your meeting insights</p>
                
                <div class="feature-controls">
                    <div class="prompt-input-group">
                        <input type="text" id="infographic-prompt" placeholder="Describe your preferred style (e.g., 'colorful corporate with icons')" />
                    </div>
                    <button id="generate-infographic-btn" class="btn-secondary" title="Generate a visual infographic from meeting insights using AI">
                        <span class="btn-text">&#127912; Generate Infographic</span>
                        <span class="btn-loader hidden">
                            <span class="spinner"></span>
                            Creating...
                        </span>
                    </button>
                </div>

                <div id="infographic-container" class="infographic-container hidden">
                    <img id="infographic-image" alt="Meeting Infographic" />
                    <button id="download-infographic-btn" class="btn-secondary" title="Download infographic as PNG image">
                        <span>&#128229;</span> Download Image
                    </button>
                </div>
            </div>

        </section>

        <!-- Error Section -->
        <section id="error-section" class="error-section hidden">
            <div class="error-content">
                <span class="error-icon">&#9888;</span>
                <p id="error-message"></p>
                <button id="dismiss-error" class="btn-secondary">Dismiss</button>
            </div>
        </section>

    </main>

    <div class="metrics-card hidden" id="metrics-card">
        <div class="metrics-card-header">
            <h4>Usage Metrics</h4>
            <div class="metrics-controls">
                <button class="metrics-download-btn" id="metrics-download-csv" title="Download CSV">‚¨áÔ∏è</button>
                <button class="metrics-pin-btn" id="metrics-pin-btn" title="Pin metrics open" style="opacity: 0.6;">üìç</button>
                <button class="metrics-toggle" id="metrics-toggle" title="Collapse/Expand">‚ñ∂</button>
            </div>
        </div>
        <div class="metrics-card-content hidden" id="metrics-content">
            <!-- Metrics will be inserted here -->
        </div>
    </div>

    <!-- How To Modal -->
    <div id="help-modal" class="modal-overlay hidden">
        <div class="modal-container help-modal-container">
            <div class="modal-header">
                <h3>üìñ How to Use northstar.LM</h3>
                <button class="modal-close" id="help-close-btn">&times;</button>
            </div>
            <div class="modal-body help-modal-body">
                <div class="help-steps">
                    <div class="help-step">
                        <div class="step-number">1</div>
                        <div class="step-content">
                            <h4>Enter Your API Key</h4>
                            <p>Get your key from <a href="https://platform.openai.com/api-keys" target="_blank">OpenAI</a> and paste it in the API Key field. It's stored locally in your browser.</p>
                        </div>
                    </div>
                    <div class="help-step">
                        <div class="step-number">2</div>
                        <div class="step-content">
                            <h4>Choose Your Input</h4>
                            <p>Select a tab (Audio, PDF, Image, Video, Text, or URL) and upload your content or paste text.</p>
                        </div>
                    </div>
                    <div class="help-step">
                        <div class="step-number">3</div>
                        <div class="step-content">
                            <h4>Analyze</h4>
                            <p>Click <strong>"Analyze Meeting"</strong> and wait for the AI to process your content.</p>
                        </div>
                    </div>
                    <div class="help-step">
                        <div class="step-number">4</div>
                        <div class="step-content">
                            <h4>Explore Results</h4>
                            <p>View the KPI dashboard, summary, key points, and action items. Use the chat to ask follow-up questions.</p>
                        </div>
                    </div>
                    <div class="help-step">
                        <div class="step-number">5</div>
                        <div class="step-content">
                            <h4>Export & Share</h4>
                            <p>Generate audio briefings, infographics, DOCX reports, or export as an Agent for the Orchestrator.</p>
                        </div>
                    </div>
                </div>
                <div class="help-tips">
                    <h4>üí° Pro Tips</h4>
                    <ul>
                        <li><strong>Agent Orchestrator:</strong> Export multiple meetings as agents, then use the Orchestrator to find patterns across them.</li>
                        <li><strong>Custom Audio:</strong> Add a style prompt before generating audio briefings (e.g., "upbeat and motivational").</li>
                        <li><strong>Image PDFs:</strong> The app automatically detects scanned PDFs and uses Vision AI for OCR.</li>
                    </ul>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn-primary" id="help-got-it-btn">Got it!</button>
            </div>
        </div>
    </div>

    <!-- Agent Name Modal -->
    <div id="agent-name-modal" class="modal-overlay hidden">
        <div class="modal-container">
            <div class="modal-header">
                <h3>ü§ñ Name Your Agent</h3>
                <button class="modal-close" id="modal-close-btn">&times;</button>
            </div>
            <div class="modal-body">
                <p class="modal-description">Give your agent a memorable name. This will help you identify it in the Orchestrator.</p>
                <div class="modal-input-group">
                    <label for="agent-name-input">Agent Name</label>
                    <input type="text" id="agent-name-input" placeholder="e.g., Q4 Planning Meeting" maxlength="100" />
                    <p class="modal-hint" id="agent-name-hint">AI-suggested name based on your meeting content</p>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn-secondary" id="modal-cancel-btn">Cancel</button>
                <button class="btn-primary" id="modal-confirm-btn">
                    <span>ü§ñ</span> Export Agent
                </button>
            </div>
        </div>
    </div>

    <!-- Wearable Coming Soon Modal -->
    <div id="wearable-modal" class="modal-overlay hidden">
        <div class="modal-container wearable-modal-container">
            <div class="modal-header">
                <h3>‚åö AI Wearable Integration</h3>
                <button class="modal-close" id="wearable-modal-close">&times;</button>
            </div>
            <div class="modal-body">
                <div class="wearable-modal-content">
                    <div class="wearable-modal-icon">üöÄ</div>
                    <h4>Coming Soon!</h4>
                    <p class="wearable-modal-desc">
                        Our team is actively developing a seamless integration with AI wearable platforms. 
                        This feature will allow you to:
                    </p>
                    <ul class="wearable-features-list">
                        <li>üì± <strong>Auto-sync recordings</strong> from your AI wearable device</li>
                        <li>üéôÔ∏è <strong>Import audio & video</strong> captured throughout your day</li>
                        <li>üìù <strong>Transcribe conversations</strong> automatically in real-time</li>
                        <li>üîó <strong>Connect multiple devices</strong> for comprehensive coverage</li>
                        <li>‚òÅÔ∏è <strong>Cloud sync</strong> for seamless access across platforms</li>
                    </ul>
                    <p class="wearable-modal-note">
                        Stay tuned for updates! We're working hard to bring you the future of meeting intelligence.
                    </p>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn-primary" id="wearable-modal-close-btn">Got it!</button>
            </div>
        </div>
    </div>

    <footer>
        <p>&copy; 2026 northstar.LM | Your meetings, distilled.</p>
        <p class="credits">
            Powered by
            <a href="https://openai.com" target="_blank">OpenAI Whisper, GPT-5.2, GPT-5.2 Vision, GPT-4o-mini-TTS & GPT-Image-1.5</a>
        </p>
    </footer>

    <!-- External Libraries -->
    <script src="https://unpkg.com/docx@8.5.0/build/index.umd.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/4.0.379/pdf.min.mjs" type="module"></script>
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <script src="js/app.js?v=48" type="module">

    <!-- Service Worker Registration with Auto-Update -->
    <script>
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', async () => {
                try {
                    const registration = await navigator.serviceWorker.register('./sw.js');
                    console.log('[PWA] Service Worker registered:', registration.scope);
                    
                    // Check for updates immediately and periodically
                    registration.update();
                    setInterval(() => registration.update(), 60 * 60 * 1000); // Check hourly
                    
                    // Handle updates
                    registration.addEventListener('updatefound', () => {
                        const newWorker = registration.installing;
                        console.log('[PWA] New version detected, installing...');
                        
                        newWorker.addEventListener('statechange', () => {
                            if (newWorker.state === 'installed' && navigator.serviceWorker.controller) {
                                // New version ready - mark as updating and reload
                                console.log('[PWA] New version ready, reloading...');
                                sessionStorage.setItem('swUpdating', 'true');
                                window.location.reload();
                            }
                        });
                    });
                    
                    // Listen for cache cleared messages
                    navigator.serviceWorker.addEventListener('message', (event) => {
                        if (event.data?.type === 'CACHE_CLEARED') {
                            console.log('[PWA] Cache cleared, version:', event.data.version);
                        }
                    });
                    
                } catch (error) {
                    console.log('[PWA] Service Worker registration failed:', error);
                }
            });
            
            // Only reload when explicitly updating, not on initial registration
            // This prevents unexpected refreshes when the SW first takes control
            let refreshing = false;
            navigator.serviceWorker.addEventListener('controllerchange', () => {
                if (!refreshing && sessionStorage.getItem('swUpdating')) {
                    refreshing = true;
                    sessionStorage.removeItem('swUpdating');
                    window.location.reload();
                }
            });
        }
    </script>
</body>
</html>
